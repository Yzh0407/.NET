## 本节目标

1. 隐式转换
2. 强制类型转换
3. Parse方法
4. ToString方法
5. Convert类


## C#数据类型转换

我们都知道 C# 是一门强类型语言，对类型要求比较严格，但是在一定的条件下也是可以相互转换的，如将 int 型数据转换成 double 型数据。

C# 允许使用两种转换方式：隐式类型转换和显式类型转换。

1) 隐式类型转换
这些转换是 C# 默认的以安全方式进行的转换，不会导致数据丢失。例如，从小的整数类型转换为大的整数类型，从派生类转换为基类。

2) 显式类型转换
显式类型转换，即强制类型转换。显式转换需要强制转换运算符，而且强制转换会造成数据丢失。

下面我们分别讲解一下数据类型转换的隐式转换、强制类型转换以及 Parse 方法、ToString 方法、Convert 类。


## 隐式数据类型转换

在 C# 语言中隐式转换是指不需要其他方法数据类型直接即可转换。

隐式转换主要是在整型、浮点型之间的转换，将存储范围小的数据类型直接转换成存储范围大的数据类型。

例如将 int 类型的值转换成 double 类型的值，将 int 类型的值转换成 long 类型的值，或者将 float 类型的值转换成 double 类型的值。

示例代码如下。

```c#
	int a = 100;
	double d = a;  //将int类型转换为double类型
	float f = 3.14f;
	d = f;    //将float类型转换为double类型
```

隐式数值转换包括以下几种：

```C#
	从 sbyte 类型到 short,int,long,float,double,或 decimal 类型。
	从 byte 类型到 short,ushort,int,uint,long,ulong,float,double,或 decimal 类型。
	从 short 类型到 int,long,float,double,或 decimal 类型。
	从 ushort 类型到 int,uint,long,ulong,float,double,或 decimal 类型。
	从 int 类型到 long,float,double,或 decimal 类型。
	从 uint 类型到 long,ulong,float,double,或 decimal 类型。
	从 long 类型到 float,double,或 decimal 类型。
	从 ulong 类型到 float,double,或 decimal 类型。
	从 char 类型到 ushort,int,uint,long,ulong,float,double,或 decimal 类型。
	从 float 类型到 double 类型。
```

其中，从 int，uint 或 long 到 float 以及从 long 到 double 的转换可能会导致精度下降，但决不会引起数量上的丢失。其它的隐式数值转换则不会有任何信息丢失。

结合我们前面在《C#基本数据类型》中学习到的每种类型的取值范围，我们可以发现，隐式数值转换实际上就是从低精度的数值类型到高精度的数值类型的转换。


## 强制数据类型转换

强制类型转换主要用于将存储范围大的数据类型转换成存储范围小的，但数据类型需要兼容。

例如 int 型转换成 float 型是可行的，但 float 型转换成 int 型则会造成数据精度丢失，而且字符串类型与整数类型之间是无法进行强制类型转换的。

强制类型转换的语法如下。

		数据类型 变量名 = (数据类型)  变量名或值;

这里要求等号左、右两边的数据类型是一致的。例如将 double 类型转换成 int 类型，代码如下。

```C#
	double dbl_num = 12345678910.456;
	int k = (int) dbl_num ;//此处运用了强制转换
```

通过上面的语句即可将浮点型转换成整数。

这样虽然能将值进行类型的转换，但损失了数据的精度，造成了数据的不准确，因此在使用强制类型转换时还需要注意数据的准确性。

## Parse方法：字符串类型转换

C# Parse 方法用于将字符串类型转换成任意类型，具体的语法形式如下。

		数据类型   变量 = 数据类型.Parse(字符串类型的值);

这里要求等号左、右两边的数据类型兼容。

【实例】在 Main 方法中从控制台输入 3 个数，并将其中的最大数输出。

根据题目要求，代码如下。

```C#
	class Program
	{
		static void Main(string[] args)
		{
			Console.WriteLine("请输入三个数字");
			int num1 = int.Parse(Console.ReadLine());
			int num2 = int.Parse(Console.ReadLine());
			int num3 = int.Parse(Console.ReadLine());
			int maxvalue = num1;
			if (num2 > maxvalue)
			{
				maxvalue = num2;
			}
			if (num3 > maxvalue)
			{
				maxvalue = num3;
			}
			Console.WriteLine("三个数中最大的值是：" + maxvalue);
		}
	}
```

执行上面的代码，查看效果。

在上面的实例中使用 Parse 方法将字符串类型转换成了整数类型 int，但输入的字符串必须是数字并且不能超出 int 类型的取值范围。

## C# ToString：将数据转换成字符串类型

C# ToString 方法用于将任意的数据类型转换成字符串类型

【实例1】将整数类型转换成字符串类型。

```C#
	int a=100;
	string str=a.ToString();
```

这样整型变量 a 即可被转换成字符串类型。

【实例2】将浮点类型转换成字符串类型。

```C#
	double d = 99.99;
	string str = d.ToString();
```

这样浮点型变量 d 即可被转换成字符串类型。

【实例3】将布尔类型转换成字符串类型。

```C#
	bool b = false;
	string str = b.ToString();
```

这样布尔型变量 b 即可被转换成字符串类型。



## Convert类：数据类型转换

C# Convert 类是数据类型转换中最灵活的方法，它能够将任意数据类型的值转换成任意数据类型，前提是不要超出指定数据类型的范围。

具体的语法形式如下。

		数据类型  变量名 = Convert.To数据类型(变量名);

这里 Convert.To 后面的数据类型要与等号左边的数据类型相匹配。

Convert 类常用的类型转换方法如下表所示。

|**方法**|**说明**|
|------------------|--------------------|
|Convert.ToByte()|转换为无符号字节类型(byte)|
|Convert.ToSbyte()|转换为有符号字节类型(sbyte)|
|Convert.ToInt16()|转换为整型(short),1byte=8bit,2*8=16|
|Convert.ToInt32()|转换为整型(int),1byte=8bit,4*8=32|
|Convert.ToInt64()|转换为整型(long),1byte=8bit,8*8=64|
|Convert.ToUInt16()|转换为 16 位无符号整数类型。|
|Convert.ToUInt32()|转换为 32 位无符号整数类型。|
|Convert.ToUInt64()|转换为 64 位无符号整数类型。|
|Convert.ToChar()|转换为字符型(char)|
|Convert.ToString()|转换为字符串型(string)|
|Convert.ToDateTime()|转换为日期型(datetime)|
|Convert.ToDecimal()|把浮点型或整数类型转换为十进制类型。|
|Convert.ToDouble()|转换为双精度浮点型(double)|
|Conert.ToSingle()|转换为单精度浮点型(float)|
|Convert.ToBoolean()|如果可能的话，把类型转换为布尔型。|


对于整型和浮点型的强制数据类型操作也可以使用 Convert 类的方法代替，但是依然会损失存储范围大的数据类型的精度。

【实例】使用 Convert类的方法将分别将一个浮点型数据转换成整型和字符串型。

根据题目要求，代码如下。

```C#
	class Program
	{
		static void Main(string[] args)
		{
			float num1 = 82.26f;
			int integer;
			string str;
			integer = Convert.ToInt32(num1);
			str = Convert.ToString(num1);
			Console.WriteLine("转换为整型数据的值{0}", integer);
			Console.WriteLine("转换为字符串{0},",str);
		}
	}
```

执行上面代码，查看效果。

## 总结
1. Parse 方法用于将字符串类型转换成任意类型
2. ToString方法将任意的数据类型转换成字符串类型
3. Convert 类是数据类型转换中最灵活的方法，它能够将任意数据类型的值转换成任意数据类型





