# 本节目标

****

1. 字符串的常用方法

2. 字符串的特点

3. StringBuilder类的使用

    

## 一、字符串的常用方法

### 1.ToUpper()

作用：将字符转换成大写形式，仅对字母有效。返回值是转换后的字符串。

使用：字符串变量.方法名();

例如：name.ToUpper();



### 2.ToLower()

作用：将字符转换成小写形式，仅对字母有效。返回值是转换后的字符串。

使用：字符串变量.方法名();

例如：name.ToUpper();

### 3.IndexOf()※

作用：查找某个字符串在字符串中第一次出现的位置。返回所在的索引位置值。如果没有找到，返回-1。

使用：字符串变量.方法名(子字符串);

例如：name.IndexOf(“on”);



### 4.LastIndexOf()

作用：查找某个字符串在字符串中最后一次出现的位置。返回所在的索引位置值。如果没有找到，返回-1。

使用：字符串变量.方法名(子字符串);

例如：name.IndexOf(“on”);



### 5.StartsWith()

作用：判断是否以...字符串开始。如果是，返回真；如果不是，返回假。

使用：字符串变量.方法名(子字符串);

例如：name.StartsWith(“Mo”);



### 6.EndsWith()

作用：判断是否以...字符串结束。如果是，返回真；如果不是，返回假。

使用：字符串变量.方法名(子字符串);

例如：name.EndsWith(“key”);



### 7.Equals() ※

作用：比较两个字符串是否相同。相同返回真，不相同返回假。

使用：字符串变量.方法名(要比较的字符串变量);

例如：name.Equals(name2);



### **8.Compare()※**

作用：对比两个字符串的大小,返回整数

使用：string.Compare(x,y)

string.Compare比较结果的含义：

| 值     | 含义                                                        |
| ------ | ----------------------------------------------------------- |
| 小于零 | x 小于 y。 或 x 为 空引用（在 Visual Basic 中为 Nothing）。 |
| 零     | x 等于 y。                                                  |
| 大于零 | x 大于 y。 或 y 为 空引用（在 Visual Basic 中为 Nothing）。 |

### 9.Replace() ※

作用：将字符串中的某个字符串替换成一个新的字符串。返回新的字符串。

使用：字符串变量.方法名(旧字符串,新字符串); 

例如：name.Replace(“Mon”, “CODE”);



### 10.Substring() ※

作用：截取字符串。返回截取后的子串。

使用：字符串变量.方法名(开始截取的位置); 				

​			字符串变量.方法名(开始截取的位置,截取多长);

| 例如：name.Substring(2); | //从角标为 2 的位置,截取到最后;    |
| ------------------------ | ---------------------------------- |
| name.Substring(2,2);     | //从角标为 2 的位置,截取 2 个字符; |



### 11.Split() ※

作用：分割字符串。返回字符串类型的数组。

使用：字符串变量.方法名(用于分割的字符数组);

例如：name3.Split(m_char);



C# Split 方法用于按照指定的字符串来拆分原有字符串，并返回拆分后得到的字符串数组。



下面用两个实例来演示字符串拆分方法的应用。

【实例 1】在 Main 方法中从控制台输入一个字符串，然后计算该字符串中包含的逗号的个数。

根据题目要求，如果要查询逗号的个数，通过拆分方法 Split 将拆分结果存放到字符串数组中，数组的长度减 1 即为字符串中含有逗号的个数，代码如下。

```C#
	class Program
	{
		static void Main(string[] args)
		{
			Console.WriteLine("请输入一个字符串：");
			string str = Console.ReadLine();
			string[] condition = { "," };
			string[] result = str.Split(condition, StringSplitOptions.None);
			Console.WriteLine("字符串中含有逗号的个数为：" + (result.Length - 1));
		}
	}
```

执行上面的代码，查看效果。

在使用 Split 方法时，需要注意该方法中传递的参数 (condition, StringSplitOptions.None)。

第一个参数是拆分的条件数组，可以在该数组中**存放多个字符串作为拆分的条件**。

第二个 参数 StringSplitOptions.None 是拆分的选项，表示如果在拆分时遇到**空字符**也拆分出一个元素。

如果在拆分时**不需要包含空字符串**，则可以使用 StringSplitOptions.RemoveEmptyEntries 选项，例如在上例中将 StringSplitOptions.None 更改成 StringSplitOptions.RemoveEmptyEntries, 语句如下。

```C#
class Program
{
		static void Main(string[] args)
		{
			Console.WriteLine("请输入一个字符串：");
			string str = Console.ReadLine();
			string[] condition = { "," };
			string[] result = str.Split(condition, StringSplitOptions.RemoveEmptyEntries);
			Console.WriteLine("字符串中含有逗号的个数为：" + (result.Length - 1));
		}
}
```

仍然执行该实例中所输入的字符串，查看效果。

从上面的执行效果可以看出，逗号的个数为 3，而前面的例子中逗号的个数为 4，这是因为当拆分“a,b,c,d,”时，最后一个逗号拆分后逗号后面的值是一个空格，因此拆分结果中数组的元素个数为 4 而不是 5。

在实际应用中，用户应根据具体情况选择拆分选项的不同值。

### 12.Contains() ※

作用：判断某个字符串中是否包含指定的字符串。如果包含返回真，否则返回假。使用：字符串变量.方法名(子字符串);

例如：name.Contains(“key”);



### 13.Trim() ※

作用：去掉字符串中前后空格。返回处理后的字符串。使用：字符串变量.方法名();

例如：address.Trim();



### 14.TrimEnd()

作用：去掉字符串结束后的空格。返回处理后的字符串。使用：字符串变量.方法名();

例如：address.TrimEnd();



### 15.TrimStart()

作用：去掉字符串开始前的空格。返回处理后的字符串。使用：字符串变量.方法名();

例如：address.TrimStart();



### 16.IsNullOrEmpty()※

作用：判断一个字符串是否为 null 或者空。如果为 null 或者空,返回真;否则返回假。 null 是不占内存空间的，而空字符串（“”）是占内存空间的。

使用：string.方法名(字符串变量);

例如：string.IsNullOrEmpty(name);



### 17.IsNullOrWhiteSpace()※

作用：判断一个字符串是否为 null 、空还是仅有空白字符组成。如果为 null 、空或者仅有空白字符组成,返回真;否则返回假。

使用：string.方法名(字符串变量);

例如：string.IsNullOrWhiteSpace(name);



### 18.Insert：字符串插入

作用：在一个字符串的指定位置插入另一个字符串。

使用：name.Insert(插入位置的下标,插入的字符串);

【实例】在 Main 方法中从控制台输入一个字符串，然后将‘@@@’插入到字符串的第 2 个字符的位置。

根据题目要求，代码如下。

```C#
class Program
{
		static void Main(string[] args)
		{
			string str = Console.ReadLine();
			str = str.Insert(1, "@@@");
			Console.WriteLine("新字符串为：" + str);
		}
	}
```

执行上面的代码，查看效果。

插入字符串

从上面的执行效果可以看出，已经将‘@@@’插入到第 2 个字符的位置。



### 19.Format()※

作用：用于数据格式化。

使用：string.format(表示格式化形式的字符串，格式化对象);

| **字符** | **说明**                              | **示例**                                    | **输出**  |
| -------- | ------------------------------------- | ------------------------------------------- | --------- |
| C        | 货币                                  | string.Format("{0:C3}", 2)                  | ＄2.000   |
| D        | 十进制                                | string.Format("{0:D3}", 2)                  | 002       |
| E        | 科学计数法                            | 1.20E+001                                   | 1.20E+001 |
| G        | 常规                                  | string.Format("{0:G}", 2)                   | 2         |
| N        | 用分号隔开的数字,并指定小数点后的位数 | string str2 =string.Format("{0:N2}",56789); | 56,789.00 |
| F        | 固定小数位数                          | string.Format("{0:F2}",56789);              | 56789.00  |
| P        | 百分比                                | string.Format("{0:P1}", 0.24583)            | 24.6%     |
| 0        | 零占位符                              | string.Format("{0:0000.00}", 194.039)       | 0194.04   |
| #        | 数字占位符                            | string.Format("{0:####.#}", 194.039)        | 194       |

常用的几种实例

**1）字符串的数字格式**

代码如下:

```C#
string str1 =string.Format("{0:N1}",56789);        //result: 56,789.0
 string str2 =string.Format("{0:N2}",56789);        //result: 56,789.00
 string str3 =string.Format("{0:N3}",56789);        //result: 56,789.000
 string str8 =string.Format("{0:F1}",56789);        //result: 56789.0
 string str9 =string.Format("{0:F2}",56789);        //result: 56789.00
```



**2）格式化货币（跟系统的环境有关，中文系统默认格式化人民币，英文系统格式化美元）**

代码如下:

string.Format("{0:C}",0.2)

结果为：￥0.20 （英文操作系统结果：$0.20）
默认格式化小数点后面保留两位小数，如果需要保留一位或者更多，可以指定位数

代码如下:

string.Format("{0:C1}",23.15)

结果为：￥23.2 （截取会自动四舍五入）



格式化多个Object实例

代码如下:

string.Format("市场价：{0:C}，优惠价{1:C}",23.15,19.82)



**3）格式化十进制的数字（格式化成固定的位数，位数不能少于未格式化前，只支持整形）**

******

代码如下:

string.Format("{0:D3}",23) //结果为：023
string.Format("{0:D2}",1223) //结果为：1223，（精度说明符指示结果字符串中所需的最少数字个数。）



**4）用分号隔开的数字，并指定小数点后的位数**

代码如下:

string.Format("{0:N}", 14200) //结果为：14,200.00 （默认为小数点后面两位）
string.Format("{0:N3}", 14200.2458) //结果为：14,200.246 （自动四舍五入）



**5）格式化百分比**

string.Format("{0:P}", 0.24583) //结果为：24.58% （默认保留百分的两位小数）
string.Format("{0:P1}", 0.24583) //结果为：24.6% （自动四舍五入）



**6）零占位符和数字占位符**

代码如下:

```C#
string.Format("{0:0000.00}", 12394.039) //结果为：12394.04
string.Format("{0:0000.00}", 194.039) //结果为：0194.04
string.Format("{0:###.##}", 12394.039) //结果为：12394.04
string.Format("{0:####.#}", 194.039) //结果为：194
```



下面的这段说明比较难理解，多测试一下实际的应用就可以明白了。
零占位符： 如果格式化的值在格式字符串中出现“0”的位置有一个数字，则此数字被复制到结果字符串中。小数点前最左边的“0”的位置和小数点后最右边的“0”的位置确定总在结果字符串中出现的数字范围。 “00”说明符使得值被舍入到小数点前最近的数字，其中零位总被舍去。
数字占位符： 如果格式化的值在格式字符串中出现“#”的位置有一个数字，则此数字被复制到结果字符串中。否则，结果字符串中的此位置不存储任何值。
请注意，如果“0”不是有效数字，此说明符永不显示“0”字符，即使“0”是字符串中唯一的数字。如果“0”是所显示的数字中的有效数字，则显示“0”字符。 “##”格式字符串使得值被舍入到小数点前最近的数字，其中零总被舍去。



**7）日期格式化** 

代码如下:

```c#
string.Format("{0:d}",System.DateTime.Now) //结果为：2009-3-20 （月份位置不是03）
string.Format("{0:D}",System.DateTime.Now) //结果为：2009年3月20日
string.Format("{0:f}",System.DateTime.Now) //结果为：2009年3月20日 15:37
string.Format("{0:F}",System.DateTime.Now) //结果为：2009年3月20日 15:37:52
string.Format("{0:g}",System.DateTime.Now) //结果为：2009-3-20 15:38
string.Format("{0:G}",System.DateTime.Now) //结果为：2009-3-20 15:39:27
string.Format("{0:m}",System.DateTime.Now) //结果为：3月20日
string.Format("{0:t}",System.DateTime.Now) //结果为：15:41
string.Format("{0:T}",System.DateTime.Now) //结果为：15:41:50
```



## 二、字符串的特点



**1.字符串是引用类型**

字符串的数据是存储在堆空间，在栈空间中存储了该数据的引用地址。



**2.字符串是不可变的**

当你给一个字符串变量重新赋值时，旧值并没有销毁，而是重新开辟一块空间来存储新值。



**3.字符串可以看做是只读的字符数组**

使用字符串变量[下标]的形式可以取字符串中指定的字符。

也可以使用 for 循环变量数组。

字符串变量.Length;可以取得字符串字符的个数。



## 三、StringBuilder类

### **StringBuilder 简介**

**1.字符串的缺点**

当需要对一个字符串变量重复赋值时，在内存中会产生大量的垃圾数据信息。当重复赋值的频率很高时，执行的效率就会降低。



**2.StringBuilder 简介**

String，字符串；Builder，构建器；连起来是“字符串构建器”。

StringBuilder 是一个类。StringBuilder 类型的变量是引用类型。

StringBuilder 类型的“字符串变量”，一直操作同一块内存空间，不会产生垃圾数据，且执行效率远远高于 string 类型的字符串变量。



### StringBuilder 使用方法

**1.创建 StringBuilder 类型的变量**

StringBuilder sb = new StringBuilder(); //创建一个对象。

注意：StringBuilder 依赖 System.Text 命名空间。



**2.往 sb 中追加数据 sb.Append(i);    //追加数据。** 

sb.ToString();  //将 sb 转成字符串形式。

演示①：单个数据的追加；

演示②：使用 for 循环循环追加数据。



**3.清空 sb 中的数据** 

sb.Clear(); //将 sb 清空。



### StringBuilder 效率测试

**1.Stopwatch 类**

Stopwatch，秒表计时器，用来记录程序运行的时间。

注意：Stopwatch 依赖 System.Diagnostics 命名空间。



**2.创建 Stopwatch 类型对象**

Stopwatch sw = new Stopwatch(); 

sw.Start();   //计时器开始。 

sw.Stop();   //计时器结束。 

sw.Elapsed; //开始到结束之间的时长。



**3.效率测试**

使用 for 循环分别往 string 和 StringBuilder 中追加 5 万个信息，统计时长。



**4.思维扩展**

今天讲解的使用“秒表计时”来判断代码在时间上的执行效率。这个测试方法不仅仅局限于今天的案例，后期需要测试执行效率的时候，都可以使用这个方法。



## 四、总结

1. System.String类的对象具有不变性
2. System.Text.StringBuilder类的对象的内容可以改变

