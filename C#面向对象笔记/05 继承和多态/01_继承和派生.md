## 本节目标
1. 理解继承概念

2. 掌握继承语法：“:”关键字

3. 使用base关键字调用父类成员方法

4. protected访问修饰符

5. 理解继承中构造器的关系

   

## 继承的概念

继承 (Inheritance) 是面向对象语言中的重要特征之一。

在 C# 语言中仅支持单重继承，主要用于解决代码的重用问题。

为了将继承关系灵活运地用到程序设计中，在 C# 语言中提供了接口来解决多重继承的关系。

在编程中灵活地使用类之间的继承关系能很好地实现类中成员的重用，有利于类的使用。

**继承：让类之间存在父子关系，子类可以继承父类的属性和方法，达到简化代码，减少代码冗余的目的。**

应用：将一堆类中的一些共有的“成员”，单独抽取出来，作为一个父类，然后让这一堆类，继承这个父类，共享父类的资源。

### 继承的好处：

- 优化代码结构，让类与类之间产生关系（人不是孤立存在的，类也一样）
- 提高代码的复用性，便于阅读（写更少的代码，干更多的活）
- 为“多态”提供前提（多态是面向对象最复杂的一个特性，后面重点讲解）

## 继承关系定义语法

在 C# 语言中实现继承非常容易，只需要用`:`符号即可完成类之间继承的表示。

类之间的继承关系的定义语法形式如下。

```C#
    [访问修饰符] class ClassB:ClassA
    {
      //类成员
    }
```

其中:

- 访问修饰符：包括public、internal。
- ClassB：称为子类、派生类，在子类中能直接使用 ClassA 中的成员。
- ClassA：称为父类、基类。

> **注意：一个类只能有一个父类（单继承），但是一个父类可以有多个子类，并且在 C# 语言中继承 关系具有传递性，即 B 类继承 A 类、C 类继承 B 类，则 C 类也相当于继承了 A 类。**



## 继承使用案例

假设要完成一个学校的校园管理信息系统，在人员管理系统中有不同的人员信息，包括学生信息、教师信息等。

学生的字段：编号（Id）、姓名（Name）、性别（Sex）、身份证号（Cardid）、联系方式（Tel）、专业（Major）、年级（Grade）

教师的字段：编号（Id）、姓名（Name）,性别 （Sex）、身份证号（Cardid）、联系方式（Tel）、职称（Title）、工资号（Wageno）

学生信息、教师信息会有一些公共的信息，例如人员编号、姓名、性别、身份证号、联系方式都是共有的。

**方法一：未使用继承**

为学生信息、教师信息创建两个类，并在两个类中分别定义属性和方法

1. 在 学生信息类（Student）中定义编号（Id）、姓名（Name）、性别（Sex）、身份证号（Cardid）、联系方式（Tel）、专业（Major）、年级（Grade）7 个属性，并定义一个方法在控制台输出这些属性的值。

​      学生信息类（Student）的代码如下。

```C#
    class Student{    
        public int Id { get; set; }    
        public string Name { get; set; }    
        public string Sex { get; set; }    
        public string Cardid { get; set; }    
        public string Tel { get; set; }    
        public string Major { get; set; }    
        public string Grade { get; set; }    
        public void Print()    {        
            Console.WriteLine("编号：" + Id);        
            Console.WriteLine("姓名：" + Name);       
            Console.WriteLine("性别：" + Sex);        
            Console.WriteLine("身份证号：" + Cardid);        
            Console.WriteLine("联系方式：" + Tel);       
            Console.WriteLine("专业：" + Major);       
            Console.WriteLine("年级：" + Grade);    
        }
    }
```

2. 在教师信息类（Teacher）中定义编号（Id）、姓名（Name）、性别 （Sex）、身份证号（Cardid）、联系方式（Tel）、职称（Title）、工资号（Wageno），并将上 述属性输岀到控制台。

教师信息类（Teacher）的代码如下。

```C#
class Teacher
{    
    public int Id { get; set; }    
    public string Name { get; set; }    
    public string Sex { get; set; }    
    public string Cardid { get; set; }    
    public string Tel { get; set; }    
    public string Title { get; set; }    
    public string WageNo { get; set; }   
    
    public void Print()    
    {        
        Console.WriteLine("编号：" + Id);       
        Console.WriteLine("姓名：" + Name);       
        Console.WriteLine("性别：" + Sex);       
        Console.WriteLine("身份证号：" + Cardid);        
        Console.WriteLine("联系方式：" + Tel);       
        Console.WriteLine("职称：" + Title);        
        Console.WriteLine("工资号：" + WageNo);    
    }
}
```

可以看到 Student 类和 Teacher 类的代码中存在很多重复的代码，如果再创建管理人员信息类或者其他的人员信息类，还会出现很多重复的代码，这样会造成大量的代码冗余。

使用类图可以清晰地看到类文件中定义的属性和方法。同样，Teacher 类对应的类图如下图所示。

![Student类和Teacher类的类图](http://c.biancheng.net/uploads/allimg/190321/4-1Z3211AT4c3.gif)

从 Student 类和 Teacher 类的类图中可以看到它们有很多重复的属性，如果将这些共同属性单独写到一个文件中，Student 类和 Teacher 类在使用这些属性和方法时直接复制这个文件中的内容就方便多了。



**方法二：使用继承抽取共同部分**

在 [C#](http://c.biancheng.net/csharp/) 语言中提供的继承特性就是解决上述问题的，将 Student 类和 Teacher 类中共有的属性抽取出来定义为一个类，然后 Student 类和 Teacher 类都继承这个共有属性类即可。

假设将共有属性类定义为 Person，在类中定义属性和方法的代码如下。

```C#
    class Person
    {    
        
        
        public int Id { get; set; }    
        public string Name { get; set; }    
        public string Sex { get; set; }    
        public string Cardid { get; set; }    
        public string Tel { get; set; }    

        public void Print()    
        {        
            Console.WriteLine("编号：" + Id);        
            Console.WriteLine("姓名：" + Name);        
            Console.WriteLine("性别：" + Sex);        
            Console.WriteLine("身份证号：" + Cardid);        
            Console.WriteLine("联系方式：" + Tel);    
        }
    }
```

创建后的 Person 类对应的类图如下图所示。



![Person类的类图](http://c.biancheng.net/uploads/allimg/190321/4-1Z3211A95D36.gif)


如果已经创建了 Person 类，则 Student 类和 Teacher 类中仅保留不同的属性和方法即可。

将 Student 类的代码更改为如下代码。

```C#
class Student
{    
    public string Major { get; set; }    
    public string Grade { get; set; }    
    
    public void Print()    
    {        
        Console.WriteLine("专业：" + Major);        
        Console.WriteLine("年级：" + Grade);    
    }
}
```

将 Teacher 类的代码更改为如下代码。

```C#
class Teacher
{    
	public string Title { get; set; }    
    public string WageNo { get; set; }  
    
    public void Print()    
    {       
        Console.WriteLine("职称：" + Title);        
        Console.WriteLine("工资号：" + WageNo);    
    }
}
```

Person、Student、Teacher 类的类图如下图所示。



![Person、Student、Teacher 类的类图](http://c.biancheng.net/uploads/allimg/190321/4-1Z3211F04L60.gif)





现在需要借助类的继承功能分别完成 Student 类和 Teacher 类继承 Person 类的操作。

Student 类继承 Person 类的代码如下。

```C#
    class Student:Person
	{
        public string Major { get; set; }    
        public string Grade { get; set; }    
        public void Print()    
        {        
            Console.WriteLine("专业：" + Major);        
            Console.WriteLine("年级：" + Grade);    
        }
    }
```

Teacher 类继承 Person 类的代码如下。

```C#
	class Teacher:Person
	{    
		public string Title { get; set; }    
		public string WageNo { get; set; }  
		
		public void Print()    
		{       
			Console.WriteLine("职称：" + Title);        
			Console.WriteLine("工资号：" + WageNo);    
		}
	}
```

项目生成的类图如下图所示

![继承关系的类图表示](http://c.biancheng.net/uploads/allimg/190321/4-1Z3211F20WN.gif)


在类图中使用箭头表示继承关系，箭头的三角形端指向父类，另一端是子类。



## base关键字：调用父类成员方法

假如：继承的子类和父类都有无参的 Print 方法

那么这种方式是方法的重载吗？答案是否定的，方法重载是指方法名相同而方法的参数不同的方法。

在 C# 语言中子类中定义的同名方法相当于在子类中重新定义了一个方法，在子类中的对象是调用不到父类中的同名方法的，调用的是子类中的方法。

因此也经常说成是将父类中的同名方法隐藏了。

【实例 1】在 Main 方法中分别创建 Person、Teacher 以及 Student 类的对 象，并调用其中的 Print 方法。

根据题目要求，代码如下。

```C#
	class Program
	{
		static void Main(string[] args)
		{
			Person person = new Person();
			Console.WriteLine("Person类的Print方法打印内容");
			person.Print();
			Student student = new Student();
			Console.WriteLine("Student类的Print方法打印内容");
			student.Print();
			Teacher teacher = new Teacher();
			Console.WriteLine("Teacher类的Print方法打印内容");
			teacher.Print();
		}
	}
```

执行上面的代码，查看效果。

从上面的执行效果可以看出，在创建不同类的对象后，调用同名的方法 Print 效果是不同的。

创建子类的对象仅能调用子类中的 Print 方法，而与父类中的 Print 方法无关。

在继承的关系中，子类如果需要调用父类中的成员可以借助 base 关键字来完成，具体的用法如下。

```C#
	base. 父类成员
```

如果在同名的方法中使用 base 关键字调用父类中的方法，则相当于把父类中的方法内容复制到该方法中。

【实例 2】改写实例 1 中的 Student 和 Teacher 类中同名的 Print 方法，使用 base 关键字 调用父类中的 Print 方法。

根据题目要求，更改后的代码如下。

```C#
	class Teacher:Person
	{
		public string Title { get; set; }
		public string WageNo { get; set; }
		public void Print()
		{
			base.Print();
			Console.WriteLine("职称：" + Title);
			Console.WriteLine("工资号：" + WageNo);
		}
	}
	class Student:Person
	{
		public string Major { get; set; }
		public string Grade { get; set; }
		public void Print()
		{
			base.Print();
			Console.WriteLine("专业：" + Major);
			Console.WriteLine("年级：" + Grade);
		}
	}
```

在实例 1 的 Main 方法中创建子类对象调用 Print 方法的代码不用修改，重新执行后查看效果。

从上面的执行效果可以看出，通过 base 关键字调用 Print 方法即可调用在父类中定义的语句。
说明：用户在程序中会遇到 this 和 base 关键字，this 关键字代表的是当前类的对象，而 base 关键字代表的是父类中的对象。

## protected访问修饰符

protected单词是保护的意思，用其修饰的类成员可以被自己和子类进行访问，但是不能被其他类访问。

访问权限介于public和private之间。

## 继承关系中构造器之间的关系

在继承关系中构造器之间究竟是什么关系呢？

先看一下实例代码，然后观察运行结果。

```C#

		class Program
		{
			static void Main(string[] args)
			{
				B b = new B();
			}
		}
		class A
		{
			public A()
			{
				Console.WriteLine("A类的构造器");
			}
		}
		class B :A
		{
			public B()
			{
				Console.WriteLine("B类的构造器");
			}
		}
```
执行上面的代码，查看效果。

构造器的执行过程

从上面的执行效果可以看出，在创建子类的实例时，**先执行父类 A 中的无参构造器，再执行子类 B 中的无参构造器**。

如果调用子类中带参数的构造器会发生什么呢？还会执行父类中的构造器吗？

将上面实例中子类 B 的代码以及 Main 方法的代码更改为如下代码。

```C#
	class Program
	{
		static void Main(string[] args)
		{
			B b = new B("ok");
		}
	}
	class A
	{
		public A()
		{
			Console.WriteLine("A类的构造器");
		}
	}
	class B :A
	{
		public B()
		{
			Console.WriteLine("B类的构造器");
		}
		public B(string name)
		{
			Console.WriteLine("B类中带参数的构造器，传入的值为：" + name);
		}
	}
```

执行上面的代码，查看效果。

调用子类中带参数的构造器

从上面的执行效果可以看出，尽管**在子类中调用了带参数的构造器，也会先调用其父类中的无参构造器。**

如果需要在子类中调用父类的构造器应该怎么办呢？直接**在子类构造器后面使用“:base(参数)”的形式**即可。

默认情况下，在子类的构造器中都会自动调用父类的无参构造器，如果需要调用父类中带参数的构造器才使用“:base(参数)”的形式。

在父类 A 中添加一个带参数的构造器，代码如下。

```C#
	class A
	{
		public A()
		{
			Console.WriteLine("A类的构造器");
		}
		public A(string name)
		{
			Console.WriteLine("A类的构造器，传入的值为：" + name);
		}
	}
	
	class B :A
	{
		public B()
		{
			Console.WriteLine("B类的构造器");
		}
		public B(string name):base(name)    //调用父类中带参数的构造器
		{
			Console.WriteLine("B类中带参数的构造器，传入的值为：" + name);
		}
	}
```

Main 方法中的内容不变，执行查看效果。

在子类中调用父类构造器

从上面的执行效果可以看出，通过在子类的构造器中使用“:base(参数)”的方式即可调用父类带参数的构造器，实际上这也是子类和父类中构造器的一种继承关系表示。
注意：如果在父类中没有无参构造器，必须在子类的构造器中继承父类的构造器，否则程序无法成功编译。

## 小结

1. 一个类可以继承另一个类，用“：”关键字实现继承；重用父类的代码；

2. 类的继承只能是单继承，一个类不能继承多个类；

3. 类的继承具有传递性，B继承A，C继承B，那么C也继承也A的属性和方法；

4. 子类只可以继承父类的非私有成员。

5. 子类不能继承父类的构造方法。子类的构造方法在调用时，会自动先调用父类的构造方法，再执行子类的构造方法。使用base关键字显示调用父类的构造方法。

6. base关键字可以访问父类的成员。

7. protected访问权限介于public和private之间。用其修饰的类成员可以被自己和子类进行访问，但是不能被其他类访问。

   

     

